import pandas as pd
import numpy as np
from sklearn.model_selection import train_test_split
from sklearn.linear_model import LinearRegression
from sklearn.metrics import mean_absolute_error, mean_squared_error, r2_score

data = pd.read_csv(r"C:\Users\ADMIN\Desktop\internship task\task 3\car data.csv")

print("Dataset Preview:")
print(data.head())
print("\nColumns:", data.columns.tolist())

if "Car_Name" in data.columns:
    data.drop("Car_Name", axis=1, inplace=True)

data.replace({
    "Fuel_Type": {"Petrol": 0, "Diesel": 1, "CNG": 2},
    "Selling_type": {"Dealer": 0, "Individual": 1},
    "Transmission": {"Manual": 0, "Automatic": 1}
}, inplace=True)

print("\nAfter encoding:")
print(data.head())

X = data.drop("Selling_Price", axis=1)
y = data["Selling_Price"]

print("\nFeature columns (in order):", X.columns.tolist())

X_train, X_test, y_train, y_test = train_test_split(
    X, y, test_size=0.2, random_state=42
)

print("X_train shape:", X_train.shape)
print("X_test shape:", X_test.shape)

model = LinearRegression()
model.fit(X_train, y_train)

y_pred = model.predict(X_test)

print("\nModel Performance:")
print("Mean Absolute Error:", mean_absolute_error(y_test, y_pred))
print("Mean Squared Error:", mean_squared_error(y_test, y_pred))
print("R2 Score:", r2_score(y_test, y_pred))

sample_input = np.array([[2017, 9.85, 6900, 0, 0, 0, 1]], dtype=float)
sample_input = sample_input.reshape(1, -1)

predicted_price = model.predict(sample_input)

print("\nPredicted Car Price:", round(predicted_price[0], 2), "Lakhs")
